<?php
/*
# This file was generated with the help of GPT-3
# https://help.openai.com/en/articles/6825453-chatgpt-release-notes
# 
# OpenAI. (2023). ChatGPT (May 24 version) [Large language model]. 
# 	https://chat.openai.com/chat
*/

    // Specify the base directory where files are stored
    $baseDir = '/var/www/html/';

    // Get the list of files in the base directory
    $files = scandir($baseDir);

    // Remove '.' and '..' from the list
    $files = array_diff($files, array('.', '..'));

    // Handle the file parameter if provided
    if (isset($_GET['file'])) {
        // Get the requested file from the URL parameter
        $file = $_GET['file'];

        // Sanitize the file path to prevent directory traversal
        $filePath = realpath($baseDir . $file);

        // Check if the file exists and is within the base directory
        if ($filePath !== false && strpos($filePath, $baseDir) === 0) {
            // Read and output the contents of the file
            $fileContents = file_get_contents($filePath);
        } else {
            // Invalid file path
            $fileContents = 'Invalid file.';
        }
    } else {
        // No file parameter provided
        $fileContents = '';
    }
?>

<!DOCTYPE html>
<html>
<head>
    <title>Directory Listing</title>
</head>
<body>
    <h1>Directory Listing</h1>
    <ul>
        <?php foreach ($files as $file) : ?>
            <li><a href="?file=<?= urlencode($file) ?>"><?= $file ?></a></li>
        <?php endforeach; ?>
    </ul>

    <hr>

    <h2>Read File</h2>
    <p>Enter (or click on) a filename to review its contents.</p>
    <form method="GET" action="">
        <input type="text" name="file" placeholder="Enter file name">
        <input type="submit" value="Read">
    </form>

    <pre><?= htmlentities($fileContents) ?></pre>
</body>
</html>
